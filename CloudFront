Cloud Front

CloudFrontのIPマッチ条件
は主に、リクエストの発信元のIPアドレスに基づいて着信Webリクエストを許可またはブロックするために使用される

ディストリビューション
ドメイン毎に割り当てられる、CloudFrontの設定単位となります。
CloudFrontディストリビューションを作成することで、コンテンツを配信する場所やアクセス制限などのさまざまな設定をCloudFrontに対して指定することが可能です。デフォルトでは「xxx.cloudfront.net」がドメイン名として割り当てられますが、CNAMEエイリアスを利用して独自のドメイン名を指定することもできます。

・クエリ文字列を使用してオリジンに一定の情報を送信することで、クエリ文字に応じて処理を変更することができます。クエリ文字列はウェブリクエストの一部で「? 」の後に追加されます。この文字列には & 文字で区切られたパラメータを 1 つ以上含めることができます。
・Cloudfront WEBディストリビューションの場合はCloudFront がクエリ文字列をオリジンに転送する際に、すべてのパラメータまたは一部のパラメータのどちらに基づいてコンテンツをキャッシュするかを選択できます。 
たとえば、WEBサイトでは ５か国語で表示されますが、ディレクトリ構造とファイル名はウェブサイトの 5 つのバージョンで共通で利用しているとします。ユーザーがこのサイトにアクセスすると、CloudFront に転送されるリクエストには、ユーザーが選択した言語に基づくクエリ文字列パラメータが含められます。選択された言語に対応して特定バージョンのページを返すようウェブサーバーを設定されたCloudFront は、それぞれの言語によるクエリ文字列パラメータの値に基づいて各言語のバージョンを個別にキャッシュします。

・CloudFrontのAPIアクセス状況をキャプチャするためにCloudTrailにログを取得できます。これは、IAM ユーザーを含めた AWS アカウントによって CloudFront API に送信されるすべてのリクエストに関する情報をキャプチャする AWS のサービス、AWS CloudTrail と統合されます。CloudTrail はこのようなリクエストのログファイルを定期的に指定の Amazon S3 バケットに保存します。

CloudFrontアクセスログを有効化
することで、CloudFront が受信するすべてのユーザーリクエストに関する詳細情報を含めたログファイルが作成されるように CloudFront を設定できます。これらは、標準ログと呼ばれます。また、アクセスログとも呼ばれています。標準ログを有効にする場合、CloudFront でファイルを保存する Amazon S3 バケットも指定できます。

CloudFrontディストリビューションでは
フェールオーバーオプション
が提供されています。高可用性が必要なシナリオでは、オリジンフェイルオーバーを使用するように CloudFront を設定できます。開始するには、プライマリとセカンダリの 2 つのオリジンを持つオリジングループを作成します。プライマリオリジンが使用できない場合、または障害を示す特定の HTTP レスポンスステータスコードを返す場合、CloudFront は自動的にセカンダリオリジンに切り替わります。

CloudFrontディストリビューションのカスタムオリジン設定として
オンプレミスロードバランサー
を設定することが可能なオプションであり、最も短期間に対応ができます。CloudFrontは非常にスケーラブルで可用性の高いコンテンツ配信サービスであり、突然の予測できないトラフィックのバーストが発生した場合でも優れたパフォーマンスを発揮できます。

・CloudFront はオリジンサーバーがオンプレミスなどのAWS 環境ではない場合でも利用できるため、様々な環境でサイトフェイルオーバーやDDoS 攻撃からの保護機能により、ウェブサイトの可用性向上が実現可能となります。

・オリジンからファイルを取得するときに、CloudFront は各エッジロケーションでファイルを圧縮します。ビューワーがリクエストヘッダーに Accept-Encoding: gzip を含めるようのリクエストするとCloudFront はファイルを圧縮して、ファイルを供給するように設定できます。
コンテンツが圧縮されるとファイルが小さくなるため、ダウンロード時間が短縮されます。これにより場合によっては、オリジナルの 4 分の 1 以下のサイズになることがあります。
CloudFront のデータ転送コストは供給されたデータの総量に基づくので、圧縮ファイルを供給すると、非圧縮ファイルを供給するよりもコストが安くなります。

・地域制限 (地理的ブロッキング) 
CloudFront ウェブディストリビューションを通じて配信しているコンテンツについて、特定地域のユーザーによるアクセスを回避できます。 

※CloudFrontとカスタムオリジン間のHTTPS オリジンがELB ロードバランサー以外のオリジンの場合、信頼されたサードパーティー認証機関 (CA) (Comodo、DigiCert、Symantec など) によって署名された証明書を使用する必要があります。

CloudFront 署名付き URL 
または
署名付き Cookie 
を作成して Amazon S3 バケット内のファイルへのアクセスを制限します。
その上で、S3バケットに直接アクセスできないように
オリジンアクセスアイデンティティ (OAI) 
という特別な CloudFront ユーザーを作成して配布に関連付けて、CloudFront が OAI を使用してファイルにアクセスしてユーザーに提供できるようにアクセス許可を構成します。これによって、署名を有するユーザーのみに限定してコンテンツを配信することが可能です。

CloudFrontにおける 
Referer制限はWAFを設定しないと実施できません
WAFのWEB ACLによる制御をReferer制限と呼びます。 
